<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranking Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">


</head>
<body>
    <div class="container">
        <h1>Rank Resumes Based on Job Description</h1>
        
        <form id="ranking-form" action="/ranking" method="POST" enctype="multipart/form-data">
            <label for="csv_file">Upload CSV File:</label>
            <input type="file" name="csv_file" id="csv_file" accept=".csv" required>
            
            <label for="job_description">Job Description:</label>
            <textarea name="job_description" id="job_description" placeholder="Enter job description..." rows="6" required></textarea>
            
            <label for="limit">Number of Resumes to Show:</label>
            <select name="limit" id="limit">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
                <option value="100">100</option>
            </select>
            
            <input type="submit" value="Rank Resumes">
        </form>

        {% if error %}
        <div class="message error">{{ error }}</div>
        {% endif %}

        {% if ranked_resumes %}
        <h2>Ranked Resumes</h2>
        <table id="resumes-table">
            <thead>
                <tr>
                    <th>Original Index</th>
                    <th>Category</th>
                    <th>Similarity</th>
                </tr>
            </thead>
            <tbody>
                {% for resume in ranked_resumes %}
                <tr class="resume-row">
                    <td>{{ resume['Original Index'] }}</td>
                    <td>{{ resume['Category'] }}</td>
                    <td>{{ resume['Similarity'] | round(2) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}
    </div>

    <a href="/">Back to Home</a>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const limitSelect = document.getElementById('limit');
            const resumeRows = document.querySelectorAll('.resume-row');

            function updateDisplayLimit() {
                const limit = parseInt(limitSelect.value);
                resumeRows.forEach((row, index) => {
                    if (index < limit) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            }

            limitSelect.addEventListener('change', updateDisplayLimit);

            // Initial update based on the selected limit
            updateDisplayLimit();
        });
    </script>
</body>
</html>
